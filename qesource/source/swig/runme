#!/bin/sh

set -e

SACLIB=../../../saclib2.2.7
JAVA=/usr/lib/jvm/java-11-openjdk-amd64

echo "This is a minimal demo to compile QEPCAD as a dynamic library and use it in a Java program natively."
echo "Make sure to run build.sh in the root folder of Tarski first."

swig -c++ -java qepcad.i

g++ -c qepcad_wrap.cxx -I../main -I.. -I$SACLIB/include \
 -I$JAVA/include -I/$JAVA/include/linux -fPIC

g++ -shared qepcad_wrap.o ../qepcad.a\
 ../../extensions/sfext/sfexto.a\
 ../../extensions/adj2d/adj2do.a\
 ../../extensions/newadj/newadjo.a\
 ../../extensions/lift2D/lift2Do.a\
 ../../extensions/rend/rendo.a\
 $SACLIB/lib/saclibo.a -o libqepcad.so -lreadline -fPIC

javac main.java

qe=`pwd`/../.. java -Djava.library.path=. main
